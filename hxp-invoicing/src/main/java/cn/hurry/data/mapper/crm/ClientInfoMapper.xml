<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.hurry.data.mapper.crm.ClientInfoMapper">
	<resultMap id="ClientResultMap" type="cn.hurry.po.crm.ClientInfo">
		<id property="id" column="id" />
	</resultMap>
	
	 <insert id="insertClientInfo" parameterType="cn.hurry.po.crm.ClientInfo">
	 	INSERT INTO client_info (name,phone,address,remark)values(#{name},#{phone},#{address},#{remark})
	 </insert>
	 
	 <delete id="deleteClientInfo" parameterType="cn.hurry.po.crm.ClientInfo" >
	 	DELETE FROM client_info where id = #{id}
	 </delete>
	 
	 <update id="updateClientInfo" parameterType="cn.hurry.po.crm.ClientInfo" >
	 	UPDATE client_info 
	 	<set>
	 		<if test="name != null">
	 			name = #{name},
	 		</if>
	 		<if test="phone != null">
	 			phone = #{phone},
	 		</if>
	 		<if test="address != null">
	 			address = #{address},
	 		</if>
	 		<if test="remark != null">
	 			remark = #{remark},
	 		</if>
	 	</set>
	 	where id = #{id}
	 </update>
	 
	 <select id="selectClientById" parameterType="int" resultMap="ClientResultMap">
	 	SELECT * FROM client_info WHERE id = #{id}
	 </select>
	 
	 <sql id="where">
	 		<if test="name != null">
	 			AND name = #{name}
	 		</if>
	 		<if test="phone != null">
	 			AND phone = #{phone}
	 		</if>
	 		<if test="address != null">
	 			AND address =  #{address}
	 		</if>
	 		<if test="remark != null">
	 			AND remark = #{remark}
	 		</if>
	 </sql>
	 
	<select id="selectClientByMap" parameterType="map" resultMap="ClientResultMap">
		SELECT * FROM client_info
		<where>
			<include refid="where"/>
		</where>
		<if test="sortField!=null and sortField!=''">
			ORDER BY ${sortField} ${sortOrder}
		</if>
		<if test="sortField==null or sortField==''">
			ORDER BY id DESC
		</if>
		<if test="firstResult != null">
			<if test="maxResults != null">
				LIMIT ${firstResult},${maxResults}
			</if>
		</if>
	</select>
	
	<select id="countClientByMap" parameterType="map" resultType="int">
		SELECT count(id) FROM client_info
		<where>
			<include refid="where"/>
		</where>
	</select>
</mapper> 